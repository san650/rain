<html>
  <style>
    .letter {
      position: fixed;
      display: block;
      width: 50px;
      height: 50px;
      font-size: 14px;
      font-weight: bold;
      background: #DAC189;
      color: #2C1901;
      border: 2px solid #EBDDC0;
    }
    .letter::before {
      font-size: 2rem;
      margin: 5px 2px 0 0;
      display: block;
      width: 100%;
      text-align: center;
      content: attr(data-symbol);
    }
    .letter::after {
      position: absolute;
      bottom: 1px;
      right: 7px;
      display: block;
      content: attr(data-symbol-value);
    }

    .rain {
      animation-name: rain;
      animation-iteration-count: 1;
      animation-direction: normal; /* we can play with reverse as a nice effect */
      animation-timing-function: linear;
      animation-fill-mode: forwards;
    }

    .d0 { animation-duration: 4s; }
    .d1 { animation-duration: 5s; }
    .d2 { animation-duration: 6s; }
    .d3 { animation-duration: 7s; }
    .d4 { animation-duration: 8s; }
    .d5 { animation-duration: 9s; }
    .d6 { animation-duration: 10s; }
    .d7 { animation-duration: 11s; }
    .d8 { animation-duration: 12s; }
    .d9 { animation-duration: 13s; }

    @keyframes rain {
      from { transform: translate(0, 0); }
      to { transform: translate(0, 100vh); }
    }

    html, body, .container {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }

    .container {
      padding: 1rem;
    }

    .container:focus::after {
      display: none;
    }
    .container::after {
      color: red;
      content: "CLICK THE PAGE TO BE ABLE TO PLAY!";
      font-size: 2rem;
    }
  </style>
  <body>
    <div id="canvas" class="container" tabindex=0></div>

    <script>
      var container = document.getElementById('canvas');
      function create(letter) {
        var span = document.createElement('span');
        span.setAttribute('data-symbol', letter.symbol);
        span.setAttribute('data-symbol-value', letter.value);
        span.style.left = letter.x;
        span.classList.add('letter');
        span.classList.add('rain');
        span.classList.add('d' + letter.duration);

        container.appendChild(span);
      }

      function random(n) {
        return Math.floor(Math.random() * n);
      }

      function randomPercentage() {
        // Use less than 100 so it doesn't overflow on the right
        return String(Math.min(random(100), 95)) + '%';
      }

      function randomDuration() {
        return random(10);
      }

      var LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      var VALUES =  [1,3,3,2,1,4,2,4,1,8,5,1,3,1,1,3,10,1,1,1,1,4,4,8,4,10];

      function randomSymbol() {
        var index = random(LETTERS.length);
        return LETTERS[index];
      }

      function valueForSymbol(symbol) {
        var index = LETTERS.indexOf(symbol);
        return VALUES[index];
      }

      function deleteElement(element) {
        var container = element.parentElement;
        container.removeChild(element);
      }

      window.setInterval(function generator() {
        var symbol = randomSymbol();

        create({
          symbol: symbol,
          value: valueForSymbol(symbol),
          x: randomPercentage(),
          duration: randomDuration() - 5,
        });
      }, 500);

      // cleanup
      container.addEventListener("animationend", function(event) {
        deleteElement(event.target);
      }, false);

      // keyboard
      container.addEventListener("keypress", function(event) {
        var key = event.key;
        var span = document.querySelector('[data-symbol="'+ key.toUpperCase() +'"]');

        if (span) {
          deleteElement(span);
          console.log('BOOM');
        }
      }, false);
      // var initialState = [
      //   { symbol: "A", x: '10%', duration: 0, value: 1 },
      //   { symbol: "B", x: '20%', duration: 1, value: 1 },
      //   { symbol: "C", x: '40%', duration: 0, value: 1 },
      //   { symbol: "D", x: '50%', duration: 2, value: 1 },
      // ].forEach(create);
      container.focus();
    </script>
  </body>
</html>
